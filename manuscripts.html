<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Gallery of Glosses</title>
    <link rel="stylesheet" href="css/gloss.css">
    <link href="favicon.ico" rel="icon" type="image/x-icon" />
    <script src="js/auth.js" type="module"></script>
    <script src="js/deer.js" type="module"></script>
    <script src="js/layout.js" type="module"></script>
    <script src="js/shared.js"></script>
</head>

<body class="container">
    <gog-header></gog-header>
    <deer-view id="ngCollectionList" deer-collection="GoG-Manuscripts"
        deer-link="manuscript-profile.html#" deer-template="manuscriptListFilterable" class="bg-basic">
        Loading&hellip;
    </deer-view>
    <gog-footer class="container"></gog-footer>
    <div id="globalFeedback" class="card is-center"></div>
</body>
<script>
/**
 * Make sure DEER forms do not submit when a user hits "Enter".
 */
document.querySelectorAll("form[deer-type]").forEach(form => {
    form.addEventListener("keydown", (e) => {
        if (e.keyIdentifier == 'U+000A' || e.keyIdentifier == 'Enter' || e.keyCode == 13) {
            if (e.target.nodeName == 'INPUT' && e.target.type == 'text') {
                e.preventDefault()
            }
        }
    }, true)
})

/**
 * UI/UX for when the user uses this page to delete an existing #ManuscriptWitness
 */
document.addEventListener("ManuscriptWitnessDeleted", function(event){
    const ev = new CustomEvent("This Witness Fragment has been deleted.")
    if(event.detail.redirect){
        globalFeedbackBlip(ev, `Witness Fragment deleted.  You will be redirected.`, true)
        addEventListener("globalFeedbackFinished", () => {
            location.reload()
        })
    }
})

/**
 * UI/UX for when this page has an error attempting to delete an existing #ManuscriptWitness.
 * The form becomes locked down and an error message is show.
 */
document.addEventListener("ManuscriptWitnessDeleteError", function(event){
    const ev = new CustomEvent("ManuscriptWitness Delete Error")
    globalFeedbackBlip(ev, `There was an deleting the Witness Fragment with URI ${event.detail["@id"]}`, false)
    addEventListener("globalFeedbackFinished", () => {
        setFieldDisabled(true)
    })
    console.error(event.error)
})
</script>

</html>